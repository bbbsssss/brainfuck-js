<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>bf</title>
    <style type="text/css">
      body {
        font-family: sans-serif;
      }
      #header {
        margin-bottom: 0;
      }
      #in {
        width: 623px;
      }
      #out {
        padding: .25em;
        background-color: gray;
      }
    </style>
  </head>
  <body>
    <h1 id="header">JavaScript bf Interpreter</h1>
    <a href="bf.js">view source</a>
    <p>
    <select id="example">
      <option value="">__Examples__</option>
      <option value="hello">Hello World!</option>
      <option value="repeat1">Repeater #1</option>
      <option value="repeat2">Repeater #2</option>
      <option value="repeat3">Repeater #3</option>
      <option value="reverse">Reverse</option>
      <option value="rot13">ROT13</option>
      <option value="fib">Fibonacci</option>
    </select></p>
    <p>
    Input <input id="in" type="text"></p>
    Program<br>
    <textarea id="bf" cols="80" rows="10"></textarea><br>
    <button id="run">Run</button>
    <input id="debug" type="checkbox"> Log to JavaScript console<br>
    <br>
    <pre id="out"></pre><br>

    <script type="text/javascript" src="bf.js"></script>
    <script type="text/javascript">
      function $(id) { return document.getElementById(id); }

      $('example').onchange = function() {
        $('out').innerText = '';

        if (this.value == 'hello') {
          $('in').value = '';
          $('bf').value = '++++++++++[>+++++++>++++++++++>+++>+<<<<-]>++.>+.+++++++..+++.>++.<<+++++++++++++++.>.+++.------.--------.>+.>.';
        }
        else if (this.value == 'repeat1') {
          $('in').value = 'Hello World!';
          $('bf').value = ',[.,]'; // 0 EOF

        }
        else if (this.value == 'repeat2') {
          $('in').value = 'Hello World!';
          $('bf').value = ',+[-.,+]'; // -1 EOF

        }
        else if (this.value == 'repeat3') {
          $('in').value = 'Hello World!';
          $('bf').value = ',[.[-],]'; // as is EOF

        }
        else if (this.value == 'reverse') {
          $('in').value = 'Hello World!';
          $('bf').value = '>-,+[>-,+]<[-.<]';
        }
        else if (this.value == 'rot13') {
          $('in').value = 'Hello World!';
          $('bf').value = '-,+[-[>>++++[>++++++++<-]<+<-[>+>+>-[>>>]<[[>+<-]>>+>]<<<<<-]]>>>[-]+>--[-[<->+++[-]]]<[++++++++++++<[>-[>+>>]>[+[<+>-]>+>>]<<<<<-]>>[<+>-]>[-[-<<[-]>>]<<[<<->>-]>>]<<[<<+>>-]]<[-]<.[-]<-,+]';
        }
        else if (this.value == 'fib') {
          $('in').value = '';
          $('bf').value = '+++++++++++>+>>>>++++++++++++++++++++++++++++++++++++++++++++>++++++++++++++++++++++++++++++++<<<<<<[>[>>>>>>+>+<<<<<<<-]>>>>>>>[<<<<<<<+>>>>>>>-]<[>++++++++++[-<-[>>+>+<<<-]>>>[<<<+>>>-]+<[>[-]<[-]]>[<<[>>>+<<<-]>>[-]]<<]>>>[>>+>+<<<-]>>>[<<<+>>>-]+<[>[-]<[-]]>[<<+>>[-]]<<<<<<<]>>>>>[++++++++++++++++++++++++++++++++++++++++++++++++.[-]]++++++++++<[->-<]>++++++++++++++++++++++++++++++++++++++++++++++++.[-]<<<<<<<<<<<<[>>>+>+<<<<-]>>>>[<<<<+>>>>-]<-[>>.>.<<<[-]]<<[>>+>+<<<-]>>>[<<<+>>>-]<<[<+>-]>[<+>-]<<<-]';
        }
        else {
          $('in').value = '';
          $('bf').value = '';
        }
      };

      // load Hello World! example on page load
      $('example').value = 'hello';
      $('example').onchange();

      $('bf').onkeydown = function(e) {
        if (e.keyCode === 9) {
          var start = this.selectionStart;
          var end = this.selectionEnd;
          var value = this.value;

          this.value = value.substring(0, start) + '\t' + value.substring(end);
          this.selectionStart = this.selectionEnd = start + 1;

          e.preventDefault();
        }
      };

      $('run').onclick = function() {
        var program = $('bf').value;
        var input = $('in').value;
        var debug = $('debug').checked;
        $('out').innerText = bf(program,input);
      };
    </script>
  </body>
</html>
